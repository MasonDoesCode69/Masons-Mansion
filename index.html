<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mason‚Äôs Mansion | V16 Singularity + Pixel Studio</title>
    <link href="fonts.googleapis.com" rel="stylesheet">
    <style>
        :root {
            --bg: #010103; --accent: #ffcc33; --glow: rgba(255, 204, 51, 0.4);
            --glass: rgba(8, 8, 12, 0.98); --border: rgba(255, 255, 255, 0.05);
            --vip: #00f2ff; --owner: #ff3333; --font-main: 'Orbitron', sans-serif;
            --font-mono: 'JetBrains Mono', monospace; --font-title: 'Syncopate', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body, html { width: 100%; height: 100%; overflow: hidden; background: var(--bg); color: #fff; font-family: var(--font-main); cursor: crosshair; }

        canvas { position: fixed; inset: 0; z-index: 0; }

        /* --- LOGIN --- */
        #auth-wrap {
            position: fixed; inset: 0; z-index: 9999; display: flex; align-items: center; justify-content: center;
            background: #000; transition: 1.5s cubic-bezier(1, 0, 0, 1);
        }
        .login-box { width: 500px; padding: 70px; background: var(--glass); border-top: 4px solid var(--accent); text-align: center; }
        .login-box h1 { font-family: 'Syncopate'; letter-spacing: 15px; font-size: 24px; color: var(--accent); margin-bottom: 50px; }
        .login-box input { width: 100%; background: #080808; border: 1px solid var(--border); padding: 20px; color: #fff; text-align: center; font-family: var(--font-mono); margin-bottom: 20px; }
        .login-btn { width: 100%; padding: 20px; background: var(--accent); font-weight: 900; border: none; cursor: pointer; letter-spacing: 5px; }

        /* --- HUD --- */
        #hud-wrap { position: fixed; top: 40px; right: 40px; text-align: right; z-index: 1000; pointer-events: none; }
        #time-main { font-size: 64px; font-weight: 900; color: var(--accent); letter-spacing: 10px; line-height: 1; }
        #date-sub { font-size: 14px; opacity: 0.5; letter-spacing: 5px; font-family: var(--font-mono); }

        /* --- PIXEL STUDIO UI --- */
        #pixel-canvas-container {
            display: grid; background: #111; border: 1px solid var(--border);
            margin: 20px auto; width: 512px; height: 512px;
            box-shadow: 0 0 50px rgba(0,0,0,0.8); cursor: cell;
        }
        .pixel { border: 1px solid rgba(255,255,255,0.03); width: 100%; height: 100%; }
        .pixel:hover { background: rgba(255,255,255,0.1); }
        .studio-controls { display: flex; gap: 10px; padding: 20px; justify-content: center; background: rgba(255,255,255,0.02); }
        .color-dot { width: 30px; height: 30px; border-radius: 5px; cursor: pointer; border: 2px solid transparent; }
        .color-dot.active { border-color: #fff; transform: scale(1.1); }

        /* --- AI --- */
        #ai-wrap { position: fixed; bottom: 120px; left: 50px; z-index: 2000; width: 350px; }
        #ai-dialog { background: var(--glass); border: 1px solid var(--border); padding: 20px; border-radius: 10px; font-size: 11px; font-family: var(--font-mono); margin-bottom: 15px; color: #aaa; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        #ai-input { width: 100%; background: rgba(255,255,255,0.03); border: 1px solid var(--border); padding: 12px; color: var(--accent); font-family: var(--font-mono); border-radius: 5px; }

        /* --- WINDOWS --- */
        .window { position: absolute; background: var(--glass); border: 1px solid var(--border); width: 1000px; height: 750px; display: none; flex-direction: column; box-shadow: 0 50px 150px rgba(0,0,0,1); z-index: 3000; overflow: hidden; }
        .win-bar { padding: 20px; background: rgba(255,255,255,0.05); cursor: move; display: flex; justify-content: space-between; font-weight: 900; font-size: 12px; letter-spacing: 5px; }
        
        /* --- TASKBAR --- */
        #taskbar { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); background: var(--glass); border: 1px solid var(--border); padding: 15px 50px; border-radius: 100px; display: flex; gap: 30px; z-index: 5000; backdrop-filter: blur(20px); }
        .nav-icon { width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; transition: 0.4s; border-radius: 50%; }
        .nav-icon:hover { transform: translateY(-20px); background: var(--accent); color: #000; }

        .hidden { display: none !important; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div id="auth-wrap">
        <div class="login-box">
            <h1>SINGULARITY</h1>
            <input type="password" id="sys-key" placeholder="ACCESS KEY">
            <button class="login-btn" onclick="Core.init()">LOGIN</button>
        </div>
    </div>

    <div id="desktop" class="hidden">
        <div id="hud-wrap">
            <div id="time-main">00:00:00</div>
            <div id="date-sub">SYNCING_2026_TIME</div>
        </div>

        <div id="ai-wrap">
            <div id="ai-dialog">M.A.V.I.S: Studio Online. Awaiting your creative input.</div>
            <input type="text" id="ai-input" placeholder="COMMAND MAVIS..." onkeypress="Core.aiTalk(event)">
        </div>

        <!-- Pixel Studio Window -->
        <div id="win-pixel" class="window" style="width:600px; height:780px;">
            <div class="win-bar"><span>üñåÔ∏è PIXEL_STUDIO_V1</span><span onclick="Core.close('pixel')" style="cursor:pointer">√ó</span></div>
            <div class="studio-controls">
                <div class="color-dot active" style="background:#ffcc33" onclick="Core.setBrush('#ffcc33', this)"></div>
                <div class="color-dot" style="background:#ff3333" onclick="Core.setBrush('#ff3333', this)"></div>
                <div class="color-dot" style="background:#00f2ff" onclick="Core.setBrush('#00f2ff', this)"></div>
                <div class="color-dot" style="background:#ffffff" onclick="Core.setBrush('#ffffff', this)"></div>
                <div class="color-dot" style="background:#000000" onclick="Core.setBrush('#000000', this)"></div>
                <button onclick="Core.clearArt()" style="background:none; border:1px solid #666; color:#fff; padding:5px 10px; cursor:pointer; font-family:var(--font-mono); font-size:10px;">PURGE_ART</button>
            </div>
            <div id="pixel-canvas-container"></div>
        </div>

        <div id="win-games" class="window">
            <div class="win-bar"><span>‚öîÔ∏è GAME_CENTRAL</span><span onclick="Core.close('games')" style="cursor:pointer">√ó</span></div>
            <div id="game-portal" style="flex:1"></div>
        </div>

        <div id="taskbar">
            <div class="nav-icon" title="Pixel Studio" onclick="Core.open('pixel')">üñåÔ∏è</div>
            <div class="nav-icon" title="Gladihoppers" onclick="Core.open('games', 'usernamegth.github.io')">‚öîÔ∏è</div>
            <div class="nav-icon" title="Slope" onclick="Core.open('games', '96f.github.io')">‚õ∑Ô∏è</div>
            <div id="owner-icon" class="nav-icon hidden">üëë</div>
        </div>
    </div>

    <script>
        const Core = {
            entities: [], brushColor: '#ffcc33', resolution: 32,
            
            init() {
                const k = document.getElementById('sys-key').value;
                if(k === "masononly69") { document.getElementById('owner-icon').classList.remove('hidden'); }
                else if(k !== "honey" && k !== "vip420") { alert("DENIED"); return; }
                
                document.getElementById('auth-wrap').style.display = 'none';
                document.getElementById('desktop').classList.remove('hidden');
                this.boot();
                this.initPixelStudio();
            },

            boot() {
                this.c = document.getElementById('canvas'); this.ctx = this.c.getContext('2d');
                window.onresize = () => { this.c.width = innerWidth; this.c.height = innerHeight; }; window.onresize();
                setInterval(() => {
                    document.getElementById('time-main').innerText = new Date().toLocaleTimeString([], {hour12:false});
                    document.getElementById('date-sub').innerText = new Date().toLocaleDateString(undefined, {weekday:'long', month:'long', day:'numeric'}).toUpperCase();
                }, 1000);
                for(let i=0; i<50; i++) this.spawn();
                this.render();
            },

            initPixelStudio() {
                const container = document.getElementById('pixel-canvas-container');
                container.style.gridTemplateColumns = `repeat(${this.resolution}, 1fr)`;
                container.innerHTML = '';
                for(let i=0; i < this.resolution * this.resolution; i++) {
                    const p = document.createElement('div');
                    p.className = 'pixel';
                    p.onmousedown = () => p.style.background = this.brushColor;
                    p.onmouseover = (e) => { if(e.buttons === 1) p.style.background = this.brushColor; };
                    container.appendChild(p);
                }
            },

            setBrush(color, el) {
                this.brushColor = color;
                document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
                el.classList.add('active');
            },

            clearArt() { document.querySelectorAll('.pixel').forEach(p => p.style.background = 'none'); },

            aiTalk(e) {
                if(e.key === 'Enter') {
                    const v = e.target.value.toLowerCase();
                    const d = document.getElementById('ai-dialog');
                    if(v.includes('clear')) { this.clearArt(); d.innerText = "MAVIS: Pixel canvas cleared."; }
                    else if(v.includes('red')) { this.brushColor = '#ff3333'; d.innerText = "MAVIS: Brush set to Crimson."; }
                    else { d.innerText = "MAVIS: Command noted. Continuing surveillance."; }
                    e.target.value = '';
                }
            },

            spawn() {
                this.entities.push({
                    x: Math.random()*innerWidth, y: Math.random()*innerHeight,
                    vx: (Math.random()-0.5)*2, vy: (Math.random()-0.5)*2,
                    sz: 20+Math.random()*30, rot: Math.random()*360
                });
            },

            open(id, url) {
                const win = document.getElementById('win-' + id);
                win.style.display = 'flex'; win.style.top = '50px'; win.style.left = '350px';
                if(url) document.getElementById('game-portal').innerHTML = `<iframe src="${url}"></iframe>`;
                this.drag(win);
            },
            close(id) { document.getElementById('win-' + id).style.display = 'none'; },

            drag(el) {
                let p1=0, p2=0, p3=0, p4=0;
                el.querySelector('.win-bar').onmousedown = (e) => {
                    p3=e.clientX; p4=e.clientY;
                    document.onmouseup = () => { document.onmouseup = null; document.onmousemove = null; };
                    document.onmousemove = (e) => {
                        p1=p3-e.clientX; p2=p4-e.clientY; p3=e.clientX; p4=e.clientY;
                        el.style.top = (el.offsetTop-p2)+"px"; el.style.left = (el.offsetLeft-p1)+"px";
                    };
                };
            },

            render() {
                this.ctx.fillStyle = '#010103'; this.ctx.fillRect(0,0,innerWidth,innerHeight);
                this.entities.forEach(e => {
                    e.x += e.vx; e.y += e.vy; e.rot += 0.5;
                    if(e.x<0 || e.x>innerWidth) e.vx*=-1; if(e.y<0 || e.y>innerHeight) e.vy*=-1;
                    this.ctx.save(); this.ctx.translate(e.x, e.y); this.ctx.rotate(e.rot*Math.PI/180);
                    this.ctx.strokeStyle = '#ffcc33'; this.ctx.lineWidth = 1;
                    this.ctx.beginPath(); this.ctx.moveTo(0,-e.sz); this.ctx.lineTo(e.sz/2,e.sz/2); this.ctx.lineTo(-e.sz/2,e.sz/2);
                    this.ctx.closePath(); this.ctx.stroke(); this.ctx.restore();
                });
                requestAnimationFrame(() => this.render());
            }
        };
    </script>
</body>
</html>
